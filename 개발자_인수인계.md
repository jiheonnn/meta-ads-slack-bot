# ì•„ì„ì›¹ ì£¼ë¬¸ ì¡°íšŒ ì‹œìŠ¤í…œ ê°œë°œì ì¸ìˆ˜ì¸ê³„ ë¬¸ì„œ

## ğŸ¯ í”„ë¡œì íŠ¸ ê°œìš”
athlogic.krì—ì„œ ì›¹ì•± ìƒí’ˆì„ íŒë§¤í•˜ê³ , êµ¬ë§¤ìë§Œ athlogic.appì— ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ í•˜ê¸° ìœ„í•´ êµ¬ë§¤ì ì •ë³´ë¥¼ ìë™ìœ¼ë¡œ ê°€ì ¸ì˜¤ëŠ” ì‹œìŠ¤í…œ

## ğŸ”„ ê°œë°œ ê³¼ì • ìš”ì•½

### 1ì°¨ ì‹œë„: API Key ë°©ì‹
- athlogic.krì˜ API Key ì‚¬ìš© ì‹œë„
- **ì‹¤íŒ¨ ì›ì¸**: API Keyê°€ ë¹„í™œì„±í™” ìƒíƒœ (errorCode 30105)

### 2ì°¨ ì‹œë„: OAuth ë°©ì‹
- ì•„ì„ì›¹ ê°œë°œìì„¼í„°ì—ì„œ OAuth ì•± ìƒì„±
- **ë‚œê´€ë“¤**:
  1. "ì—°ë™ë˜ì§€ ì•Šì€ ì‚¬ì´íŠ¸" ì˜¤ë¥˜ â†’ ê°œë°œìì„¼í„°ì—ì„œ ì•±-ì‚¬ì´íŠ¸ ì—°ë™ í•„ìš”
  2. "Invalid redirect uri" ì˜¤ë¥˜ â†’ ì •í™•í•œ URI ì°¾ê¸° í•„ìš”
  3. Site Code ì˜¤ë¥˜ â†’ ì˜¬ë°”ë¥¸ ì‚¬ì´íŠ¸ ì½”ë“œ í™•ì¸ í•„ìš”
  4. Scope ê¶Œí•œ ì˜¤ë¥˜ â†’ `site-info:write`ê°€ í•„ìˆ˜ ê¶Œí•œì„ì„ ë°œê²¬

### ìµœì¢… í•´ê²°
- OAuth 2.0 Authorization Code Flow ì‚¬ìš©
- í•„ìˆ˜ scope: `site-info:write order:read`
- Redirect URI: `https://petebaek0712000.imweb.me/`

## ğŸ—ï¸ ì‹œìŠ¤í…œ êµ¬ì¡°

```
1. OAuth ì¸ì¦ (get_first_token.py)
   â†“
2. í† í° ì €ì¥ (imweb_tokens.json)
   â†“
3. ì£¼ë¬¸ ì¡°íšŒ (get_orders_oauth_correct.py)
   â†“
4. êµ¬ë§¤ì ì •ë³´ ì¶”ì¶œ ë° CSV ì €ì¥
```

## ğŸ“ í•µì‹¬ ì½”ë“œ ì„¤ëª…

### 1. OAuth ì¸ì¦ URL ìƒì„±
```python
params = {
    'responseType': 'code',
    'clientId': CLIENT_ID,
    'redirectUri': REDIRECT_URI,
    'scope': 'site-info:write order:read',  # í•„ìˆ˜!
    'siteCode': SITE_CODE,
    'state': 'random_state'
}
```

### 2. ì£¼ë¬¸ ì¡°íšŒ ì‹œ ì£¼ì˜ì‚¬í•­
- ë‚ ì§œ íŒŒë¼ë¯¸í„°: `startWtime`, `endWtime` (UTC ISO8601 í˜•ì‹)
- ì‘ë‹µ êµ¬ì¡°: `data.list` (ë¬¸ì„œì™€ ë‹¤ë¦„)
- ìƒí’ˆëª… ìœ„ì¹˜: `sections[].sectionItems[].productInfo.prodName`
- êµ¬ë§¤ì ì •ë³´: `ordererName`, `ordererCall`, `ordererEmail`

### 3. í˜ì´ì§€ë„¤ì´ì…˜ í•„ìˆ˜
```python
params = {
    'page': 1,
    'limit': 100  # í•„ìˆ˜ íŒŒë¼ë¯¸í„°
}
```

## ğŸš¨ ì£¼ìš” ì´ìŠˆ ë° í•´ê²°

### 1. ì•„ì„ì›¹ API ë¬¸ì„œì™€ ì‹¤ì œ êµ¬í˜„ì˜ ì°¨ì´
- ë¬¸ì„œ: `data.orders`
- ì‹¤ì œ: `data.list`

### 2. ë‚ ì§œ í•„í„°ê°€ ì‘ë™í•˜ì§€ ì•ŠìŒ
- APIì˜ ë‚ ì§œ í•„í„°ê°€ ì œëŒ€ë¡œ ì‘ë™í•˜ì§€ ì•Šì•„ ì „ì²´ ì¡°íšŒ í›„ í•„í„°ë§ í•„ìš”

### 3. í† í° ê°±ì‹ 
- Access Token ë§Œë£Œ ì‹œ ìë™ ê°±ì‹  êµ¬í˜„
- `oauth_token_manager.py`ì—ì„œ ì²˜ë¦¬

## ğŸ”— ì—°ë™ í•„ìš” ì‚¬í•­

### athlogic.app ì¸¡ êµ¬í˜„ í•„ìš”
1. êµ¬ë§¤ì ë“±ë¡ API ì—”ë“œí¬ì¸íŠ¸
2. êµ¬ë§¤ì ì¸ì¦ ì‹œìŠ¤í…œ
3. êµ¬ë§¤ì ë°ì´í„°ë² ì´ìŠ¤

### ìë™í™” ì œì•ˆ
```python
# 5ë¶„ë§ˆë‹¤ ìƒˆ êµ¬ë§¤ì í™•ì¸
import schedule
import time

def check_new_buyers():
    # get_orders_oauth_correct.py ë¡œì§ ì‹¤í–‰
    pass

schedule.every(5).minutes.do(check_new_buyers)

while True:
    schedule.run_pending()
    time.sleep(1)
```

## ğŸ“š ì°¸ê³  ìë£Œ
- ì•„ì„ì›¹ API ë¬¸ì„œ: `imweb_guide.md`
- OAuth 2.0 ìŠ¤í™: https://oauth.net/2/

## âš¡ ë¹ ë¥¸ ì‹œì‘
```bash
# 1. íŒ¨í‚¤ì§€ ì„¤ì¹˜
pip3 install requests

# 2. í† í° ë°œê¸‰ (ìµœì´ˆ 1íšŒ)
python3 get_first_token.py

# 3. ì£¼ë¬¸ ì¡°íšŒ
python3 get_orders_oauth_correct.py
```

## ğŸ”® í–¥í›„ ê°œì„  ì‚¬í•­
1. ì›¹í›… ë°©ì‹ ë„ì… (ì•„ì„ì›¹ì´ ì§€ì› ì‹œ)
2. ì‹¤ì‹œê°„ ë™ê¸°í™”
3. êµ¬ë§¤ì ìë™ ì•Œë¦¼ ì‹œìŠ¤í…œ
4. ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ êµ¬í˜„